

============================== 2024-04-18 20:11:01.902732 | c115ce02-feef-46b6-a43f-49d51aec39cf ==============================
[0m20:11:01.902732 [info ] [MainThread]: Running with dbt=1.4.7
[0m20:11:01.905191 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:11:01.905982 [debug] [MainThread]: Tracking: tracking
[0m20:11:01.908500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d943d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d943d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d943d390>]}
[0m20:11:01.921050 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m20:11:01.927698 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:11:01.928690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c115ce02-feef-46b6-a43f-49d51aec39cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d943d7e0>]}
[0m20:11:02.585367 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m20:11:02.597617 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m20:11:02.602397 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m20:11:02.607030 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m20:11:02.698691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d7b2b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d7b2a620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d7b2a230>]}
[0m20:11:02.700315 [debug] [MainThread]: Flushing usage events
[0m20:11:02.864835 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.custom_postgres.actors' (models/example/actors.sql) depends on a source named 'destinaion_db.actors' which was not found


============================== 2024-04-18 20:13:18.193606 | 3ca9d201-6e2c-43bd-a552-e7935c5fab2a ==============================
[0m20:13:18.193606 [info ] [MainThread]: Running with dbt=1.4.7
[0m20:13:18.196473 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:13:18.197668 [debug] [MainThread]: Tracking: tracking
[0m20:13:18.199971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3c36d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3c36d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3c36d390>]}
[0m20:13:18.211919 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m20:13:18.218582 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:13:18.219595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3ca9d201-6e2c-43bd-a552-e7935c5fab2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3c36d7e0>]}
[0m20:13:18.905549 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m20:13:18.917201 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m20:13:18.921055 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m20:13:18.925555 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m20:13:19.020581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3aa56bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3aa57d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3aa55c30>]}
[0m20:13:19.021825 [debug] [MainThread]: Flushing usage events
[0m20:13:19.360327 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.custom_postgres.films' (models/example/films.sql) depends on a source named 'destination_db.film' which was not found


============================== 2024-04-18 20:15:15.422919 | 3c02f989-c819-4b0d-85d4-f38c9630bc2e ==============================
[0m20:15:15.422919 [info ] [MainThread]: Running with dbt=1.4.7
[0m20:15:15.427141 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:15:15.428822 [debug] [MainThread]: Tracking: tracking
[0m20:15:15.432284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d27d9d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d27d9d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d27d9d3c0>]}
[0m20:15:15.455093 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m20:15:15.465350 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:15:15.467065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3c02f989-c819-4b0d-85d4-f38c9630bc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d27d9d810>]}
[0m20:15:16.252577 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m20:15:16.266541 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m20:15:16.270941 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m20:15:16.276351 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m20:15:16.436665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c02f989-c819-4b0d-85d4-f38c9630bc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d264e58a0>]}
[0m20:15:16.459802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c02f989-c819-4b0d-85d4-f38c9630bc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d27d9fe20>]}
[0m20:15:16.461268 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:15:16.462592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c02f989-c819-4b0d-85d4-f38c9630bc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d2648ac50>]}
[0m20:15:16.465480 [info ] [MainThread]: 
[0m20:15:16.468131 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:15:16.470235 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:15:16.483647 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:15:16.484911 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:15:16.485824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:16.531848 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m20:15:16.534168 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:15:16.537270 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m20:15:16.544883 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:15:16.546311 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:15:16.547487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:16.566730 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:15:16.567983 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:15:16.568964 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:15:16.574048 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m20:15:16.576167 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:15:16.579921 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:15:16.586987 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:16.588629 [debug] [MainThread]: On master: BEGIN
[0m20:15:16.590344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:15:16.613134 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:15:16.614986 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:16.616368 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:15:16.624022 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m20:15:16.626251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c02f989-c819-4b0d-85d4-f38c9630bc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d24b512d0>]}
[0m20:15:16.627531 [debug] [MainThread]: On master: ROLLBACK
[0m20:15:16.631659 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:16.633120 [debug] [MainThread]: On master: BEGIN
[0m20:15:16.638614 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:15:16.640031 [debug] [MainThread]: On master: COMMIT
[0m20:15:16.641044 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:16.642017 [debug] [MainThread]: On master: COMMIT
[0m20:15:16.645814 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:15:16.647529 [debug] [MainThread]: On master: Close
[0m20:15:16.649555 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:15:16.651133 [info ] [MainThread]: 
[0m20:15:16.676745 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:15:16.678568 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:15:16.680915 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m20:15:16.682248 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:15:16.687638 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:15:16.711497 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-18 20:15:16.683463 => 2024-04-18 20:15:16.711330
[0m20:15:16.712802 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:15:16.756450 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:15:16.784432 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:15:16.785699 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:15:16.786575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:16.805794 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:15:16.806962 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:15:16.807967 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destinarion_db"."public"."actors"
  );
  
[0m20:15:16.811070 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "destinarion_db.public.actors"
LINE 8:     SELECT * FROM "destinarion_db"."public"."actors"
                          ^

[0m20:15:16.812862 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:15:16.816843 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-18 20:15:16.714194 => 2024-04-18 20:15:16.816715
[0m20:15:16.818570 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:15:16.821740 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  cross-database references are not implemented: "destinarion_db.public.actors"
  LINE 8:     SELECT * FROM "destinarion_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:15:16.823305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c02f989-c819-4b0d-85d4-f38c9630bc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d24b8a8c0>]}
[0m20:15:16.824757 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m20:15:16.827743 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:15:16.830129 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:15:16.832021 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:15:16.834495 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m20:15:16.836478 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:15:16.840593 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:15:16.852212 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-18 20:15:16.837626 => 2024-04-18 20:15:16.852006
[0m20:15:16.854183 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:15:16.859762 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:15:16.871813 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:15:16.872958 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:15:16.874002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:16.894462 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:15:16.895803 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:15:16.896957 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destinarion_db"."public"."film_actors"
  );
  
[0m20:15:16.899870 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "destinarion_db.public.film_actors"
LINE 8:     SELECT * FROM "destinarion_db"."public"."film_actors"
                          ^

[0m20:15:16.901395 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:15:16.905516 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-18 20:15:16.855368 => 2024-04-18 20:15:16.905347
[0m20:15:16.908083 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:15:16.910212 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  cross-database references are not implemented: "destinarion_db.public.film_actors"
  LINE 8:     SELECT * FROM "destinarion_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:15:16.911780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c02f989-c819-4b0d-85d4-f38c9630bc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d24bffeb0>]}
[0m20:15:16.913381 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.08s]
[0m20:15:16.915524 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:15:16.917132 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:15:16.919220 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:15:16.921953 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m20:15:16.923423 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:15:16.927214 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:15:16.938964 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-18 20:15:16.924433 => 2024-04-18 20:15:16.938821
[0m20:15:16.940166 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:15:16.945031 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:15:16.955637 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:15:16.956618 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:15:16.957574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:16.976855 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:15:16.978004 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:15:16.979359 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destinarion_db"."public"."films"
  );
  
[0m20:15:16.983034 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "destinarion_db.public.films"
LINE 8:     SELECT * FROM "destinarion_db"."public"."films"
                          ^

[0m20:15:16.984455 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:15:16.987816 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-18 20:15:16.941087 => 2024-04-18 20:15:16.987705
[0m20:15:16.988879 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:15:16.991104 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  cross-database references are not implemented: "destinarion_db.public.films"
  LINE 8:     SELECT * FROM "destinarion_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:15:16.992644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c02f989-c819-4b0d-85d4-f38c9630bc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d24b74370>]}
[0m20:15:16.994178 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m20:15:16.995661 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:15:16.998862 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:15:17.000534 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:15:17.002807 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:15:17.006196 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:15:17.007621 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:17.008591 [debug] [MainThread]: On master: BEGIN
[0m20:15:17.010042 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:15:17.034001 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:15:17.036234 [debug] [MainThread]: On master: COMMIT
[0m20:15:17.037776 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:17.039049 [debug] [MainThread]: On master: COMMIT
[0m20:15:17.043114 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:15:17.045078 [debug] [MainThread]: On master: Close
[0m20:15:17.047372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:17.048964 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:15:17.050564 [info ] [MainThread]: 
[0m20:15:17.053214 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m20:15:17.055438 [debug] [MainThread]: Command end result
[0m20:15:17.077913 [info ] [MainThread]: 
[0m20:15:17.080496 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:15:17.082200 [info ] [MainThread]: 
[0m20:15:17.084526 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m20:15:17.085732 [error] [MainThread]:   cross-database references are not implemented: "destinarion_db.public.actors"
[0m20:15:17.087065 [error] [MainThread]:   LINE 8:     SELECT * FROM "destinarion_db"."public"."actors"
[0m20:15:17.088513 [error] [MainThread]:                             ^
[0m20:15:17.089841 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:15:17.091140 [info ] [MainThread]: 
[0m20:15:17.092504 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m20:15:17.093929 [error] [MainThread]:   cross-database references are not implemented: "destinarion_db.public.film_actors"
[0m20:15:17.096046 [error] [MainThread]:   LINE 8:     SELECT * FROM "destinarion_db"."public"."film_actors"
[0m20:15:17.098229 [error] [MainThread]:                             ^
[0m20:15:17.099801 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:15:17.101212 [info ] [MainThread]: 
[0m20:15:17.103069 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m20:15:17.105682 [error] [MainThread]:   cross-database references are not implemented: "destinarion_db.public.films"
[0m20:15:17.108095 [error] [MainThread]:   LINE 8:     SELECT * FROM "destinarion_db"."public"."films"
[0m20:15:17.109480 [error] [MainThread]:                             ^
[0m20:15:17.110903 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:15:17.112254 [info ] [MainThread]: 
[0m20:15:17.114324 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:15:17.116228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d2648ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d264c3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d264c1810>]}
[0m20:15:17.117508 [debug] [MainThread]: Flushing usage events


============================== 2024-04-18 20:17:25.874170 | 2d6ee3dd-c77b-4af0-8cc5-921ce75188a8 ==============================
[0m20:17:25.874170 [info ] [MainThread]: Running with dbt=1.4.7
[0m20:17:25.878216 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:17:25.879160 [debug] [MainThread]: Tracking: tracking
[0m20:17:25.881573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2055ba1360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2055ba17e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2055ba13c0>]}
[0m20:17:25.902879 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m20:17:26.113794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:17:26.115803 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/sources.yaml
[0m20:17:26.141123 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m20:17:26.157557 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m20:17:26.162411 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m20:17:26.166603 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m20:17:26.293482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d6ee3dd-c77b-4af0-8cc5-921ce75188a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2052b4db40>]}
[0m20:17:26.316018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d6ee3dd-c77b-4af0-8cc5-921ce75188a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2055b743a0>]}
[0m20:17:26.317263 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:17:26.318405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d6ee3dd-c77b-4af0-8cc5-921ce75188a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20575beda0>]}
[0m20:17:26.321868 [info ] [MainThread]: 
[0m20:17:26.326193 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:17:26.329017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:17:26.344414 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:17:26.346100 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:17:26.347115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:26.377067 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m20:17:26.380433 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:17:26.384209 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m20:17:26.391417 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:17:26.392869 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:17:26.394443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:26.415205 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:17:26.416396 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:17:26.417358 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:17:26.422351 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m20:17:26.424391 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:17:26.427496 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:17:26.435228 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:26.436309 [debug] [MainThread]: On master: BEGIN
[0m20:17:26.437163 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:17:26.461727 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:17:26.463206 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:26.464454 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:17:26.471921 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m20:17:26.474315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d6ee3dd-c77b-4af0-8cc5-921ce75188a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2054314dc0>]}
[0m20:17:26.475877 [debug] [MainThread]: On master: ROLLBACK
[0m20:17:26.479923 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:26.481477 [debug] [MainThread]: On master: BEGIN
[0m20:17:26.487653 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:17:26.489132 [debug] [MainThread]: On master: COMMIT
[0m20:17:26.490279 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:26.491304 [debug] [MainThread]: On master: COMMIT
[0m20:17:26.494752 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:17:26.496300 [debug] [MainThread]: On master: Close
[0m20:17:26.498263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:17:26.515306 [info ] [MainThread]: 
[0m20:17:26.545574 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:17:26.547468 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:17:26.550766 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m20:17:26.553132 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:17:26.557713 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:17:26.570110 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-18 20:17:26.554452 => 2024-04-18 20:17:26.569849
[0m20:17:26.571337 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:17:26.625985 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:17:26.637162 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:17:26.638286 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:17:26.639264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:26.661919 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:17:26.663258 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:17:26.664381 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:17:26.667721 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m20:17:26.669286 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:17:26.673081 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-18 20:17:26.572399 => 2024-04-18 20:17:26.672910
[0m20:17:26.674949 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:17:26.678922 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:17:26.680622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d6ee3dd-c77b-4af0-8cc5-921ce75188a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2052c01240>]}
[0m20:17:26.682293 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.13s]
[0m20:17:26.686530 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:17:26.688047 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:17:26.689469 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:17:26.691124 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m20:17:26.692605 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:17:26.698560 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:17:26.715510 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-18 20:17:26.694270 => 2024-04-18 20:17:26.715298
[0m20:17:26.717614 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:17:26.725241 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:17:26.739528 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:17:26.740768 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:17:26.741770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:26.767431 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:17:26.768994 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:17:26.770183 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:17:26.774680 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m20:17:26.776939 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:17:26.781395 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-18 20:17:26.720732 => 2024-04-18 20:17:26.781180
[0m20:17:26.783329 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:17:26.786263 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:17:26.788857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d6ee3dd-c77b-4af0-8cc5-921ce75188a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2052a37d30>]}
[0m20:17:26.790767 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.10s]
[0m20:17:26.792408 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:17:26.794595 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:17:26.797888 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:17:26.800144 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m20:17:26.802551 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:17:26.810081 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:17:26.824203 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-18 20:17:26.804794 => 2024-04-18 20:17:26.824016
[0m20:17:26.825820 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:17:26.833677 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:17:26.845807 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:17:26.847315 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:17:26.848926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:26.871442 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:17:26.872672 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:17:26.873748 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:17:26.877216 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m20:17:26.878682 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:17:26.882319 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-18 20:17:26.827342 => 2024-04-18 20:17:26.882167
[0m20:17:26.884141 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:17:26.886261 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:17:26.887522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d6ee3dd-c77b-4af0-8cc5-921ce75188a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2052ab1d20>]}
[0m20:17:26.889068 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.09s]
[0m20:17:26.890838 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:17:26.893179 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:17:26.894744 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:17:26.896213 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:17:26.900355 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:17:26.901508 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:26.902454 [debug] [MainThread]: On master: BEGIN
[0m20:17:26.903447 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:17:26.924137 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:17:26.925225 [debug] [MainThread]: On master: COMMIT
[0m20:17:26.926458 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:26.927907 [debug] [MainThread]: On master: COMMIT
[0m20:17:26.932175 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:17:26.933687 [debug] [MainThread]: On master: Close
[0m20:17:26.935821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:26.937246 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:17:26.938692 [info ] [MainThread]: 
[0m20:17:26.940013 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m20:17:26.941718 [debug] [MainThread]: Command end result
[0m20:17:26.961349 [info ] [MainThread]: 
[0m20:17:26.963143 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:17:26.964875 [info ] [MainThread]: 
[0m20:17:26.967075 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m20:17:26.968220 [error] [MainThread]:   relation "public.actors" does not exist
[0m20:17:26.969346 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m20:17:26.970423 [error] [MainThread]:                             ^
[0m20:17:26.971424 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:17:26.972534 [info ] [MainThread]: 
[0m20:17:26.973391 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m20:17:26.974236 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m20:17:26.975382 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m20:17:26.976847 [error] [MainThread]:                             ^
[0m20:17:26.978453 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:17:26.979618 [info ] [MainThread]: 
[0m20:17:26.982907 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m20:17:26.984264 [error] [MainThread]:   relation "public.films" does not exist
[0m20:17:26.985335 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m20:17:26.986660 [error] [MainThread]:                             ^
[0m20:17:26.987969 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:17:26.989090 [info ] [MainThread]: 
[0m20:17:26.990198 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:17:26.991350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2052bfe1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2052a28040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2052ab1c90>]}
[0m20:17:26.992622 [debug] [MainThread]: Flushing usage events


============================== 2024-04-18 20:28:34.992457 | 5e1f3d78-2e50-4a8b-8c75-c2db29cc30d8 ==============================
[0m20:28:34.992457 [info ] [MainThread]: Running with dbt=1.4.7
[0m20:28:34.995446 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:28:34.996582 [debug] [MainThread]: Tracking: tracking
[0m20:28:34.999195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1208bd9360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1208bd97e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1208bd93c0>]}
[0m20:28:35.026872 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m20:28:35.251789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:35.253036 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:35.261708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e1f3d78-2e50-4a8b-8c75-c2db29cc30d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1207308b20>]}
[0m20:28:35.283034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e1f3d78-2e50-4a8b-8c75-c2db29cc30d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12072d2140>]}
[0m20:28:35.284339 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:28:35.285802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e1f3d78-2e50-4a8b-8c75-c2db29cc30d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12072d21a0>]}
[0m20:28:35.288020 [info ] [MainThread]: 
[0m20:28:35.290752 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:28:35.292838 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:28:35.304435 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:28:35.306085 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:28:35.307499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:35.345528 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m20:28:35.347706 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:28:35.351493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m20:28:35.360620 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:28:35.361914 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:28:35.362906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:35.380199 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:28:35.381226 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:28:35.381997 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:28:35.386663 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m20:28:35.388503 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:28:35.390659 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:28:35.395812 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:35.396932 [debug] [MainThread]: On master: BEGIN
[0m20:28:35.397836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:35.413504 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:28:35.415781 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:35.419649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:28:35.429244 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m20:28:35.432243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e1f3d78-2e50-4a8b-8c75-c2db29cc30d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12073578b0>]}
[0m20:28:35.437366 [debug] [MainThread]: On master: ROLLBACK
[0m20:28:35.441342 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:35.443169 [debug] [MainThread]: On master: BEGIN
[0m20:28:35.448200 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:28:35.453104 [debug] [MainThread]: On master: COMMIT
[0m20:28:35.455286 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:35.456916 [debug] [MainThread]: On master: COMMIT
[0m20:28:35.460392 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:28:35.461705 [debug] [MainThread]: On master: Close
[0m20:28:35.463037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:35.463926 [info ] [MainThread]: 
[0m20:28:35.478256 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:28:35.479388 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:28:35.480603 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m20:28:35.481338 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:28:35.485188 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:28:35.492429 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-18 20:28:35.481928 => 2024-04-18 20:28:35.492309
[0m20:28:35.493228 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:28:35.529952 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:28:35.538885 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:28:35.539632 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:28:35.540376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:35.557541 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:28:35.558606 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:28:35.559438 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:28:35.561546 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m20:28:35.562362 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:28:35.564476 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-18 20:28:35.493814 => 2024-04-18 20:28:35.564397
[0m20:28:35.565251 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:28:35.568703 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:28:35.570391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e1f3d78-2e50-4a8b-8c75-c2db29cc30d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f120719e890>]}
[0m20:28:35.571393 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.09s]
[0m20:28:35.573601 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:28:35.574533 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:28:35.575352 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:28:35.576383 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m20:28:35.577111 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:28:35.580587 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:28:35.589392 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-18 20:28:35.577655 => 2024-04-18 20:28:35.589267
[0m20:28:35.590202 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:28:35.593853 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:28:35.602702 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:28:35.603713 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:28:35.604443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:35.621995 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:28:35.623054 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:28:35.623784 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:28:35.626423 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m20:28:35.627616 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:28:35.630296 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-18 20:28:35.590819 => 2024-04-18 20:28:35.630193
[0m20:28:35.630996 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:28:35.632358 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:28:35.633899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e1f3d78-2e50-4a8b-8c75-c2db29cc30d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12071c4190>]}
[0m20:28:35.636505 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.06s]
[0m20:28:35.637918 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:28:35.638940 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:28:35.640207 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:28:35.641677 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m20:28:35.642597 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:28:35.645964 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:28:35.655391 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-18 20:28:35.643248 => 2024-04-18 20:28:35.655271
[0m20:28:35.656567 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:28:35.660708 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:28:35.669770 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:28:35.670734 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:28:35.671358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:35.688604 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:28:35.689561 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:28:35.690150 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:28:35.692207 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m20:28:35.693248 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:28:35.695812 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-18 20:28:35.657342 => 2024-04-18 20:28:35.695713
[0m20:28:35.696579 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:28:35.697923 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:28:35.698895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e1f3d78-2e50-4a8b-8c75-c2db29cc30d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f120719eda0>]}
[0m20:28:35.700334 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.06s]
[0m20:28:35.703155 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:28:35.705406 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:28:35.706649 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:28:35.708036 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:28:35.711117 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:28:35.712012 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:35.713036 [debug] [MainThread]: On master: BEGIN
[0m20:28:35.713986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:28:35.732776 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:28:35.735487 [debug] [MainThread]: On master: COMMIT
[0m20:28:35.737636 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:35.738816 [debug] [MainThread]: On master: COMMIT
[0m20:28:35.741493 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:28:35.742549 [debug] [MainThread]: On master: Close
[0m20:28:35.743534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:35.744456 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:28:35.745527 [info ] [MainThread]: 
[0m20:28:35.746842 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m20:28:35.748126 [debug] [MainThread]: Command end result
[0m20:28:35.767539 [info ] [MainThread]: 
[0m20:28:35.770430 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:28:35.771718 [info ] [MainThread]: 
[0m20:28:35.773092 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m20:28:35.774450 [error] [MainThread]:   relation "public.actors" does not exist
[0m20:28:35.775611 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m20:28:35.776644 [error] [MainThread]:                             ^
[0m20:28:35.777651 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:28:35.778720 [info ] [MainThread]: 
[0m20:28:35.779610 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m20:28:35.780425 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m20:28:35.781463 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m20:28:35.782672 [error] [MainThread]:                             ^
[0m20:28:35.785072 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:28:35.787627 [info ] [MainThread]: 
[0m20:28:35.788856 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m20:28:35.789952 [error] [MainThread]:   relation "public.films" does not exist
[0m20:28:35.791179 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m20:28:35.792224 [error] [MainThread]:                             ^
[0m20:28:35.793161 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:28:35.794013 [info ] [MainThread]: 
[0m20:28:35.794817 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:28:35.795734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1207357730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12071c5f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12071c4af0>]}
[0m20:28:35.796432 [debug] [MainThread]: Flushing usage events


============================== 2024-04-18 20:31:08.891944 | e0cfd0d1-84fe-4eda-a9bf-3ddeb7f6991f ==============================
[0m20:31:08.891944 [info ] [MainThread]: Running with dbt=1.4.7
[0m20:31:08.895788 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:31:08.897103 [debug] [MainThread]: Tracking: tracking
[0m20:31:08.900327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1801a61360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1801a617e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1801a613c0>]}
[0m20:31:08.918824 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m20:31:09.147615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m20:31:09.149445 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_actors.sql
[0m20:31:09.150960 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/films.sql
[0m20:31:09.152187 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/actors.sql
[0m20:31:09.177118 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m20:31:09.198300 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m20:31:09.203224 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m20:31:09.336907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0cfd0d1-84fe-4eda-a9bf-3ddeb7f6991f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17fe80beb0>]}
[0m20:31:09.374714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0cfd0d1-84fe-4eda-a9bf-3ddeb7f6991f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1801a793c0>]}
[0m20:31:09.376391 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:31:09.378306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0cfd0d1-84fe-4eda-a9bf-3ddeb7f6991f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1801a789d0>]}
[0m20:31:09.383718 [info ] [MainThread]: 
[0m20:31:09.388024 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:31:09.391809 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:31:09.418632 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:31:09.420532 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:31:09.422981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:09.462611 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m20:31:09.466831 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:31:09.470924 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m20:31:09.481821 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:31:09.483639 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:31:09.485356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:31:09.508881 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:31:09.510170 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:31:09.511261 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:31:09.517664 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m20:31:09.520357 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:31:09.523966 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:31:09.533032 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:09.534823 [debug] [MainThread]: On master: BEGIN
[0m20:31:09.535942 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:31:09.560170 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:31:09.561559 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:09.562609 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:31:09.570991 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m20:31:09.573673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0cfd0d1-84fe-4eda-a9bf-3ddeb7f6991f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17fe8235e0>]}
[0m20:31:09.575149 [debug] [MainThread]: On master: ROLLBACK
[0m20:31:09.578598 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:09.579880 [debug] [MainThread]: On master: BEGIN
[0m20:31:09.585863 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:31:09.587638 [debug] [MainThread]: On master: COMMIT
[0m20:31:09.589278 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:09.590349 [debug] [MainThread]: On master: COMMIT
[0m20:31:09.593644 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:31:09.594856 [debug] [MainThread]: On master: Close
[0m20:31:09.596499 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:31:09.598612 [info ] [MainThread]: 
[0m20:31:09.624002 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:31:09.625559 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:31:09.627163 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m20:31:09.628568 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:31:09.633209 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:31:09.645624 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-18 20:31:09.629818 => 2024-04-18 20:31:09.645435
[0m20:31:09.647127 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:31:09.706571 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:31:09.719904 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:31:09.721011 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:31:09.722158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:09.742888 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:31:09.744101 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:31:09.745195 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:31:09.749033 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m20:31:09.750604 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:31:09.754381 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-18 20:31:09.649487 => 2024-04-18 20:31:09.754199
[0m20:31:09.755815 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:31:09.761843 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:31:09.763691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0cfd0d1-84fe-4eda-a9bf-3ddeb7f6991f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1800169b70>]}
[0m20:31:09.765470 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m20:31:09.771284 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:31:09.774175 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:31:09.775758 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:31:09.777708 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m20:31:09.779088 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:31:09.784267 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:31:09.801989 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-18 20:31:09.780236 => 2024-04-18 20:31:09.801748
[0m20:31:09.803718 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:31:09.810190 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:31:09.821817 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:31:09.823181 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:31:09.824432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:09.852504 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:31:09.853947 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:31:09.855349 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:31:09.859771 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m20:31:09.861481 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:31:09.866094 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-18 20:31:09.805167 => 2024-04-18 20:31:09.865937
[0m20:31:09.867710 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:31:09.870504 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:31:09.873206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0cfd0d1-84fe-4eda-a9bf-3ddeb7f6991f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17fe8b83a0>]}
[0m20:31:09.875162 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.10s]
[0m20:31:09.876994 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:31:09.878847 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:31:09.880436 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:31:09.883938 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m20:31:09.885462 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:31:09.892162 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:31:09.905728 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-18 20:31:09.886761 => 2024-04-18 20:31:09.905480
[0m20:31:09.908563 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:31:09.914758 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:31:09.928534 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:31:09.929768 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:31:09.931199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:09.959427 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:31:09.960783 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:31:09.962011 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:31:09.965910 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m20:31:09.967680 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:31:09.971945 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-18 20:31:09.909961 => 2024-04-18 20:31:09.971707
[0m20:31:09.974064 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:31:09.977121 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:31:09.978859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0cfd0d1-84fe-4eda-a9bf-3ddeb7f6991f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1800169ab0>]}
[0m20:31:09.980959 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.10s]
[0m20:31:09.982961 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:31:09.987275 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:31:09.989010 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:31:09.990980 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:31:09.994644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:31:09.996078 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:09.997537 [debug] [MainThread]: On master: BEGIN
[0m20:31:09.999046 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:31:10.028471 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:31:10.030012 [debug] [MainThread]: On master: COMMIT
[0m20:31:10.031686 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:10.033337 [debug] [MainThread]: On master: COMMIT
[0m20:31:10.037752 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:31:10.040497 [debug] [MainThread]: On master: Close
[0m20:31:10.042617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:31:10.043904 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:31:10.045450 [info ] [MainThread]: 
[0m20:31:10.047385 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m20:31:10.049409 [debug] [MainThread]: Command end result
[0m20:31:10.080694 [info ] [MainThread]: 
[0m20:31:10.083070 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:31:10.084988 [info ] [MainThread]: 
[0m20:31:10.086660 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m20:31:10.088522 [error] [MainThread]:   relation "public.actors" does not exist
[0m20:31:10.092615 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m20:31:10.094807 [error] [MainThread]:                             ^
[0m20:31:10.096587 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:31:10.098515 [info ] [MainThread]: 
[0m20:31:10.100697 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m20:31:10.102754 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m20:31:10.104143 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m20:31:10.106450 [error] [MainThread]:                             ^
[0m20:31:10.110466 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:31:10.112056 [info ] [MainThread]: 
[0m20:31:10.114084 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m20:31:10.116302 [error] [MainThread]:   relation "public.films" does not exist
[0m20:31:10.118155 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m20:31:10.119632 [error] [MainThread]:                             ^
[0m20:31:10.121172 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:31:10.125532 [info ] [MainThread]: 
[0m20:31:10.127664 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:31:10.129651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17fe8cceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17fe8cc400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17fe8cf3a0>]}
[0m20:31:10.132073 [debug] [MainThread]: Flushing usage events


============================== 2024-04-18 20:46:48.523428 | 7feca704-879e-4636-b61f-5a46ea7e4d52 ==============================
[0m20:46:48.523428 [info ] [MainThread]: Running with dbt=1.4.7
[0m20:46:48.527028 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:46:48.527922 [debug] [MainThread]: Tracking: tracking
[0m20:46:48.532142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61d7610f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61d7617b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61d761390>]}
[0m20:46:48.552742 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m20:46:48.801584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:46:48.802907 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:46:48.810689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7feca704-879e-4636-b61f-5a46ea7e4d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61be98ac0>]}
[0m20:46:48.834603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7feca704-879e-4636-b61f-5a46ea7e4d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61be5e0e0>]}
[0m20:46:48.835893 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:46:48.837043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7feca704-879e-4636-b61f-5a46ea7e4d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61be5e140>]}
[0m20:46:48.840203 [info ] [MainThread]: 
[0m20:46:48.843835 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:46:48.846453 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:46:48.859975 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:46:48.861523 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:46:48.862746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:48.896613 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m20:46:48.898927 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:46:48.903195 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m20:46:48.911529 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:46:48.912538 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:46:48.913390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:48.934681 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:46:48.936020 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:46:48.937096 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:46:48.942248 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m20:46:48.944312 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:46:48.947583 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:46:48.954521 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:48.955709 [debug] [MainThread]: On master: BEGIN
[0m20:46:48.956676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:46:48.978559 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:46:48.979901 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:48.980965 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:46:48.988730 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m20:46:48.991116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7feca704-879e-4636-b61f-5a46ea7e4d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61bee38b0>]}
[0m20:46:48.993273 [debug] [MainThread]: On master: ROLLBACK
[0m20:46:49.000309 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:49.002165 [debug] [MainThread]: On master: BEGIN
[0m20:46:49.019379 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:46:49.020831 [debug] [MainThread]: On master: COMMIT
[0m20:46:49.021900 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:49.023064 [debug] [MainThread]: On master: COMMIT
[0m20:46:49.028536 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:46:49.030004 [debug] [MainThread]: On master: Close
[0m20:46:49.031628 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:46:49.032932 [info ] [MainThread]: 
[0m20:46:49.056109 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:46:49.058047 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:46:49.061754 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m20:46:49.063133 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:46:49.067447 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:46:49.082074 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-18 20:46:49.064148 => 2024-04-18 20:46:49.081923
[0m20:46:49.087281 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:46:49.145842 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:46:49.157230 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:46:49.158659 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:46:49.160210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:49.181651 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:46:49.182759 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:46:49.184284 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:46:49.188975 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m20:46:49.190660 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:46:49.194601 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-18 20:46:49.088994 => 2024-04-18 20:46:49.194465
[0m20:46:49.196031 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:46:49.203249 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:46:49.204990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7feca704-879e-4636-b61f-5a46ea7e4d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61bd26890>]}
[0m20:46:49.206365 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m20:46:49.209133 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:46:49.210895 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:46:49.212335 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:46:49.214103 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m20:46:49.215721 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:46:49.221838 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:46:49.235997 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-18 20:46:49.217061 => 2024-04-18 20:46:49.235772
[0m20:46:49.237579 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:46:49.244279 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:46:49.259077 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:46:49.260483 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:46:49.261721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:49.287015 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:46:49.288192 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:46:49.289042 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:46:49.292237 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m20:46:49.293729 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:46:49.297659 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-18 20:46:49.238760 => 2024-04-18 20:46:49.297541
[0m20:46:49.300262 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:46:49.303002 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:46:49.304468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7feca704-879e-4636-b61f-5a46ea7e4d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61bd4c130>]}
[0m20:46:49.305862 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.09s]
[0m20:46:49.307524 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:46:49.309047 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:46:49.310314 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:46:49.311962 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m20:46:49.312923 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:46:49.316716 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:46:49.329980 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-18 20:46:49.313795 => 2024-04-18 20:46:49.329758
[0m20:46:49.331241 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:46:49.338477 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:46:49.353456 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:46:49.354967 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:46:49.356696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:49.382923 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:46:49.384564 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:46:49.385951 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:46:49.390408 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m20:46:49.391974 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:46:49.395340 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-18 20:46:49.332071 => 2024-04-18 20:46:49.395222
[0m20:46:49.396707 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:46:49.398879 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:46:49.401399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7feca704-879e-4636-b61f-5a46ea7e4d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61bd26d40>]}
[0m20:46:49.403768 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.09s]
[0m20:46:49.406128 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:46:49.411338 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:46:49.412761 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:46:49.413946 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:46:49.417385 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:46:49.419274 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:49.420705 [debug] [MainThread]: On master: BEGIN
[0m20:46:49.421902 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:46:49.449586 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:46:49.451522 [debug] [MainThread]: On master: COMMIT
[0m20:46:49.453097 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:49.454615 [debug] [MainThread]: On master: COMMIT
[0m20:46:49.459262 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:46:49.462394 [debug] [MainThread]: On master: Close
[0m20:46:49.463853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:49.465022 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:46:49.466495 [info ] [MainThread]: 
[0m20:46:49.468607 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m20:46:49.470999 [debug] [MainThread]: Command end result
[0m20:46:49.495742 [info ] [MainThread]: 
[0m20:46:49.496859 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:46:49.498230 [info ] [MainThread]: 
[0m20:46:49.499332 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m20:46:49.501248 [error] [MainThread]:   relation "public.actors" does not exist
[0m20:46:49.503083 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m20:46:49.505084 [error] [MainThread]:                             ^
[0m20:46:49.506457 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:46:49.508869 [info ] [MainThread]: 
[0m20:46:49.511647 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m20:46:49.513485 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m20:46:49.514769 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m20:46:49.516442 [error] [MainThread]:                             ^
[0m20:46:49.518407 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:46:49.520559 [info ] [MainThread]: 
[0m20:46:49.522309 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m20:46:49.523537 [error] [MainThread]:   relation "public.films" does not exist
[0m20:46:49.524755 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m20:46:49.525950 [error] [MainThread]:                             ^
[0m20:46:49.527738 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:46:49.529814 [info ] [MainThread]: 
[0m20:46:49.532287 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:46:49.535113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61bee3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61bd4ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61bd4eda0>]}
[0m20:46:49.537558 [debug] [MainThread]: Flushing usage events


============================== 2024-04-18 20:52:25.009585 | aced17c1-3dff-4cfc-9c57-c645419886a6 ==============================
[0m20:52:25.009585 [info ] [MainThread]: Running with dbt=1.4.7
[0m20:52:25.014391 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:52:25.015929 [debug] [MainThread]: Tracking: tracking
[0m20:52:25.018968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1fecd0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1fecd7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1fecd390>]}
[0m20:52:25.049652 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m20:52:25.343097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:52:25.344730 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:52:25.355491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aced17c1-3dff-4cfc-9c57-c645419886a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1e60cb20>]}
[0m20:52:25.382768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aced17c1-3dff-4cfc-9c57-c645419886a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1e5d6140>]}
[0m20:52:25.384286 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:52:25.385700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aced17c1-3dff-4cfc-9c57-c645419886a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1e5d61a0>]}
[0m20:52:25.388849 [info ] [MainThread]: 
[0m20:52:25.391724 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:52:25.394177 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:52:25.406818 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:52:25.409089 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:52:25.411846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:25.441183 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m20:52:25.443903 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:52:25.448054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m20:52:25.457825 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:52:25.459535 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:52:25.461193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:25.482746 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:52:25.484250 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:52:25.485396 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:52:25.491808 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m20:52:25.494801 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:52:25.498184 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:52:25.504349 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:25.505469 [debug] [MainThread]: On master: BEGIN
[0m20:52:25.506360 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:25.525505 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:52:25.526874 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:25.527986 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:52:25.534827 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m20:52:25.536592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aced17c1-3dff-4cfc-9c57-c645419886a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1e45b8b0>]}
[0m20:52:25.537606 [debug] [MainThread]: On master: ROLLBACK
[0m20:52:25.541016 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:25.542341 [debug] [MainThread]: On master: BEGIN
[0m20:52:25.548835 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:52:25.550193 [debug] [MainThread]: On master: COMMIT
[0m20:52:25.551079 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:25.551830 [debug] [MainThread]: On master: COMMIT
[0m20:52:25.554624 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:52:25.555722 [debug] [MainThread]: On master: Close
[0m20:52:25.557007 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:25.558077 [info ] [MainThread]: 
[0m20:52:25.574378 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:52:25.575801 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:52:25.577845 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m20:52:25.579526 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:52:25.584867 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:52:25.596382 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-18 20:52:25.580512 => 2024-04-18 20:52:25.596196
[0m20:52:25.597967 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:52:25.654485 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:52:25.668233 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:52:25.669471 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:52:25.670780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:25.690095 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:52:25.691445 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:52:25.692756 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:52:25.697994 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m20:52:25.699785 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:52:25.704359 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-18 20:52:25.600594 => 2024-04-18 20:52:25.704224
[0m20:52:25.706444 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:52:25.709894 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:52:25.711636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aced17c1-3dff-4cfc-9c57-c645419886a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1e4ae890>]}
[0m20:52:25.713298 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.13s]
[0m20:52:25.716739 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:52:25.722336 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:52:25.724119 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:52:25.730403 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m20:52:25.733183 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:52:25.743820 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:52:25.760371 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-18 20:52:25.736771 => 2024-04-18 20:52:25.760124
[0m20:52:25.762230 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:52:25.768974 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:52:25.779973 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:52:25.781656 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:52:25.782541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:25.802017 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:52:25.803163 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:52:25.804006 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:52:25.807047 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m20:52:25.808297 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:52:25.811551 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-18 20:52:25.763773 => 2024-04-18 20:52:25.811390
[0m20:52:25.812865 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:52:25.815490 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:52:25.817765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aced17c1-3dff-4cfc-9c57-c645419886a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1e4c0190>]}
[0m20:52:25.819100 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.09s]
[0m20:52:25.820151 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:52:25.821223 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:52:25.822050 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:52:25.823324 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m20:52:25.824475 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:52:25.828352 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:52:25.839260 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-18 20:52:25.825265 => 2024-04-18 20:52:25.839134
[0m20:52:25.840144 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:52:25.844911 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:52:25.856025 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:52:25.856954 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:52:25.857768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:25.878893 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:52:25.880440 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:52:25.881561 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:52:25.884684 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m20:52:25.885709 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:52:25.888464 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-18 20:52:25.840892 => 2024-04-18 20:52:25.888368
[0m20:52:25.889331 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:52:25.890895 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:52:25.891984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aced17c1-3dff-4cfc-9c57-c645419886a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1e4aeda0>]}
[0m20:52:25.893820 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m20:52:25.895800 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:52:25.898836 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:52:25.900918 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:52:25.904388 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:52:25.907488 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:52:25.909172 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:25.910395 [debug] [MainThread]: On master: BEGIN
[0m20:52:25.911576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:25.935667 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:52:25.937081 [debug] [MainThread]: On master: COMMIT
[0m20:52:25.938058 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:25.939199 [debug] [MainThread]: On master: COMMIT
[0m20:52:25.941974 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:52:25.942986 [debug] [MainThread]: On master: Close
[0m20:52:25.944912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:25.946469 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:52:25.948452 [info ] [MainThread]: 
[0m20:52:25.949833 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m20:52:25.951320 [debug] [MainThread]: Command end result
[0m20:52:25.969980 [info ] [MainThread]: 
[0m20:52:25.971384 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:52:25.972471 [info ] [MainThread]: 
[0m20:52:25.973585 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m20:52:25.974640 [error] [MainThread]:   relation "public.actors" does not exist
[0m20:52:25.975975 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m20:52:25.977137 [error] [MainThread]:                             ^
[0m20:52:25.978656 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:52:25.980403 [info ] [MainThread]: 
[0m20:52:25.981740 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m20:52:25.983857 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m20:52:25.987788 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m20:52:25.989182 [error] [MainThread]:                             ^
[0m20:52:25.990526 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:52:25.991732 [info ] [MainThread]: 
[0m20:52:25.992852 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m20:52:25.994188 [error] [MainThread]:   relation "public.films" does not exist
[0m20:52:25.995984 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m20:52:25.997576 [error] [MainThread]:                             ^
[0m20:52:25.998942 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:52:26.003728 [info ] [MainThread]: 
[0m20:52:26.005418 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:52:26.007022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1e45b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1e4c2e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1e4c0af0>]}
[0m20:52:26.008500 [debug] [MainThread]: Flushing usage events


============================== 2024-04-18 20:55:53.458128 | 5fb728a0-ef28-4235-ba48-55de50fee238 ==============================
[0m20:55:53.458128 [info ] [MainThread]: Running with dbt=1.4.7
[0m20:55:53.461102 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:55:53.462133 [debug] [MainThread]: Tracking: tracking
[0m20:55:53.464285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa00dbd0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa00dbd7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa00dbd390>]}
[0m20:55:53.481868 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m20:55:53.678254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:55:53.679790 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:55:53.688785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fb728a0-ef28-4235-ba48-55de50fee238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9ff4f4b20>]}
[0m20:55:53.709662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fb728a0-ef28-4235-ba48-55de50fee238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9ff4ba140>]}
[0m20:55:53.711024 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:55:53.712085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fb728a0-ef28-4235-ba48-55de50fee238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9ff4ba1a0>]}
[0m20:55:53.714850 [info ] [MainThread]: 
[0m20:55:53.718135 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:55:53.722387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:55:53.740135 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:55:53.742142 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:55:53.744269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:53.774118 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m20:55:53.778979 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:55:53.783369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m20:55:53.790394 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:55:53.791636 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:55:53.792839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:53.809819 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:55:53.812242 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:55:53.813395 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:55:53.818010 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m20:55:53.820061 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:55:53.822477 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:55:53.829897 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:53.832031 [debug] [MainThread]: On master: BEGIN
[0m20:55:53.833391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:55:53.853859 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:55:53.854962 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:53.855801 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:55:53.861677 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m20:55:53.864290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fb728a0-ef28-4235-ba48-55de50fee238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9ff53b8b0>]}
[0m20:55:53.865347 [debug] [MainThread]: On master: ROLLBACK
[0m20:55:53.867887 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:53.868715 [debug] [MainThread]: On master: BEGIN
[0m20:55:53.872853 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:55:53.873912 [debug] [MainThread]: On master: COMMIT
[0m20:55:53.874623 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:53.875452 [debug] [MainThread]: On master: COMMIT
[0m20:55:53.878827 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:55:53.880822 [debug] [MainThread]: On master: Close
[0m20:55:53.882466 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:55:53.883608 [info ] [MainThread]: 
[0m20:55:53.899200 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:55:53.901245 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:55:53.902914 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m20:55:53.903934 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:55:53.907299 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:55:53.919266 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-18 20:55:53.904560 => 2024-04-18 20:55:53.919092
[0m20:55:53.920654 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:55:53.963910 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:55:53.977631 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:55:53.979703 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:55:53.980998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:53.998418 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:55:53.999704 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:55:54.000626 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:55:54.003361 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m20:55:54.004925 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:55:54.008198 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-18 20:55:53.921507 => 2024-04-18 20:55:54.008021
[0m20:55:54.009863 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:55:54.013863 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:55:54.016096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb728a0-ef28-4235-ba48-55de50fee238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9ff396890>]}
[0m20:55:54.017483 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m20:55:54.020323 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:55:54.021639 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:55:54.022674 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:55:54.024258 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m20:55:54.025984 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:55:54.031691 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:55:54.041164 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-18 20:55:54.027138 => 2024-04-18 20:55:54.040867
[0m20:55:54.042703 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:55:54.051194 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:55:54.072445 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:55:54.074644 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:55:54.076825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:54.097254 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:55:54.098419 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:55:54.099309 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:55:54.101982 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m20:55:54.103260 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:55:54.106720 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-18 20:55:54.044306 => 2024-04-18 20:55:54.106581
[0m20:55:54.108282 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:55:54.112618 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:55:54.114247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb728a0-ef28-4235-ba48-55de50fee238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9ff3a8190>]}
[0m20:55:54.115732 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.09s]
[0m20:55:54.116878 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:55:54.118248 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:55:54.119238 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:55:54.120522 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m20:55:54.121403 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:55:54.124991 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:55:54.135141 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-18 20:55:54.122166 => 2024-04-18 20:55:54.135022
[0m20:55:54.136091 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:55:54.140232 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:55:54.151213 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:55:54.152193 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:55:54.152914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:54.171745 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:55:54.172946 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:55:54.173694 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:55:54.177240 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m20:55:54.179898 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:55:54.182877 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-18 20:55:54.136746 => 2024-04-18 20:55:54.182771
[0m20:55:54.184144 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:55:54.185965 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:55:54.187187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb728a0-ef28-4235-ba48-55de50fee238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9ff396da0>]}
[0m20:55:54.188597 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m20:55:54.189750 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:55:54.192152 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:55:54.193685 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:55:54.195081 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:55:54.198805 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:55:54.201031 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:54.201873 [debug] [MainThread]: On master: BEGIN
[0m20:55:54.202619 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:55:54.223430 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:55:54.224598 [debug] [MainThread]: On master: COMMIT
[0m20:55:54.225710 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:54.226973 [debug] [MainThread]: On master: COMMIT
[0m20:55:54.230070 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:55:54.231997 [debug] [MainThread]: On master: Close
[0m20:55:54.233247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:54.234093 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:55:54.235045 [info ] [MainThread]: 
[0m20:55:54.236117 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m20:55:54.237642 [debug] [MainThread]: Command end result
[0m20:55:54.256457 [info ] [MainThread]: 
[0m20:55:54.257674 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:55:54.258896 [info ] [MainThread]: 
[0m20:55:54.260606 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m20:55:54.262151 [error] [MainThread]:   relation "public.actors" does not exist
[0m20:55:54.263441 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m20:55:54.265945 [error] [MainThread]:                             ^
[0m20:55:54.268145 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:55:54.269253 [info ] [MainThread]: 
[0m20:55:54.270454 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m20:55:54.271497 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m20:55:54.272736 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m20:55:54.273841 [error] [MainThread]:                             ^
[0m20:55:54.275183 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:55:54.277087 [info ] [MainThread]: 
[0m20:55:54.278527 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m20:55:54.279735 [error] [MainThread]:   relation "public.films" does not exist
[0m20:55:54.281510 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m20:55:54.284559 [error] [MainThread]:                             ^
[0m20:55:54.286159 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:55:54.287461 [info ] [MainThread]: 
[0m20:55:54.288565 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:55:54.289760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9ff53b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9ff3a9d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9ff3a8190>]}
[0m20:55:54.291114 [debug] [MainThread]: Flushing usage events


============================== 2024-04-18 21:00:42.245548 | 1959eab2-c85a-44fc-8f6f-bf3844ec3135 ==============================
[0m21:00:42.245548 [info ] [MainThread]: Running with dbt=1.4.7
[0m21:00:42.249632 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:00:42.250982 [debug] [MainThread]: Tracking: tracking
[0m21:00:42.255645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1fb690f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1fb697b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1fb69390>]}
[0m21:00:42.283711 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m21:00:42.526880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:00:42.528014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:00:42.537378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1959eab2-c85a-44fc-8f6f-bf3844ec3135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1e29ca60>]}
[0m21:00:42.560093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1959eab2-c85a-44fc-8f6f-bf3844ec3135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1e266080>]}
[0m21:00:42.561576 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m21:00:42.562858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1959eab2-c85a-44fc-8f6f-bf3844ec3135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1e2660e0>]}
[0m21:00:42.565598 [info ] [MainThread]: 
[0m21:00:42.568982 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:00:42.572070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m21:00:42.589155 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m21:00:42.592244 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m21:00:42.593399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:42.621242 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m21:00:42.625369 [debug] [ThreadPool]: On list_destination_db: Close
[0m21:00:42.628920 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m21:00:42.637553 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m21:00:42.639722 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m21:00:42.640777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:42.659078 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m21:00:42.660175 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m21:00:42.661307 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:00:42.665794 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m21:00:42.668040 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m21:00:42.670711 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m21:00:42.677224 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:42.678679 [debug] [MainThread]: On master: BEGIN
[0m21:00:42.680159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:42.698942 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:00:42.700100 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:42.700972 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:00:42.707038 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m21:00:42.709125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1959eab2-c85a-44fc-8f6f-bf3844ec3135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1e2eb8b0>]}
[0m21:00:42.711698 [debug] [MainThread]: On master: ROLLBACK
[0m21:00:42.714963 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:42.715881 [debug] [MainThread]: On master: BEGIN
[0m21:00:42.721895 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:00:42.723232 [debug] [MainThread]: On master: COMMIT
[0m21:00:42.724496 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:42.725652 [debug] [MainThread]: On master: COMMIT
[0m21:00:42.728876 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m21:00:42.729948 [debug] [MainThread]: On master: Close
[0m21:00:42.731185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:00:42.732075 [info ] [MainThread]: 
[0m21:00:42.749127 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m21:00:42.750549 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m21:00:42.751933 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m21:00:42.753175 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m21:00:42.757626 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m21:00:42.768632 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-18 21:00:42.754429 => 2024-04-18 21:00:42.768502
[0m21:00:42.769822 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m21:00:42.811460 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m21:00:42.826175 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:00:42.827428 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m21:00:42.828371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:42.846488 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:00:42.847625 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:00:42.848432 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m21:00:42.851049 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m21:00:42.852294 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m21:00:42.856161 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-18 21:00:42.771290 => 2024-04-18 21:00:42.856022
[0m21:00:42.857838 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m21:00:42.861336 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m21:00:42.862636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1959eab2-c85a-44fc-8f6f-bf3844ec3135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1e132890>]}
[0m21:00:42.863878 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m21:00:42.866424 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m21:00:42.867620 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m21:00:42.868547 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m21:00:42.871190 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m21:00:42.873000 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m21:00:42.878200 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m21:00:42.889252 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-18 21:00:42.874372 => 2024-04-18 21:00:42.888737
[0m21:00:42.892374 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m21:00:42.897335 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m21:00:42.909888 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:00:42.910963 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m21:00:42.911908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:42.930039 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:00:42.931242 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:00:42.932242 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m21:00:42.935478 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m21:00:42.937143 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m21:00:42.942198 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-18 21:00:42.893584 => 2024-04-18 21:00:42.942079
[0m21:00:42.943254 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m21:00:42.944803 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m21:00:42.946256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1959eab2-c85a-44fc-8f6f-bf3844ec3135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1e154340>]}
[0m21:00:42.947666 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.08s]
[0m21:00:42.948991 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m21:00:42.950004 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m21:00:42.950810 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m21:00:42.952049 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m21:00:42.953033 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m21:00:42.957935 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m21:00:42.968052 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-18 21:00:42.954085 => 2024-04-18 21:00:42.967902
[0m21:00:42.969162 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m21:00:42.976168 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m21:00:42.986402 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:00:42.988102 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m21:00:42.990714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:43.011926 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:00:43.013099 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:00:43.013759 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m21:00:43.016373 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m21:00:43.017376 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m21:00:43.020118 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-18 21:00:42.970210 => 2024-04-18 21:00:43.020015
[0m21:00:43.021520 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m21:00:43.025097 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m21:00:43.026472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1959eab2-c85a-44fc-8f6f-bf3844ec3135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1e132e90>]}
[0m21:00:43.027611 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m21:00:43.028601 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m21:00:43.030094 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m21:00:43.031088 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m21:00:43.031991 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m21:00:43.034255 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:00:43.035186 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:43.035992 [debug] [MainThread]: On master: BEGIN
[0m21:00:43.036907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:43.058798 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:00:43.060203 [debug] [MainThread]: On master: COMMIT
[0m21:00:43.061111 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:43.061891 [debug] [MainThread]: On master: COMMIT
[0m21:00:43.064648 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m21:00:43.065592 [debug] [MainThread]: On master: Close
[0m21:00:43.067176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:43.068585 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m21:00:43.070066 [info ] [MainThread]: 
[0m21:00:43.072010 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m21:00:43.075551 [debug] [MainThread]: Command end result
[0m21:00:43.094991 [info ] [MainThread]: 
[0m21:00:43.096155 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m21:00:43.097335 [info ] [MainThread]: 
[0m21:00:43.098745 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m21:00:43.100050 [error] [MainThread]:   relation "public.actors" does not exist
[0m21:00:43.101330 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m21:00:43.102561 [error] [MainThread]:                             ^
[0m21:00:43.104431 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m21:00:43.107051 [info ] [MainThread]: 
[0m21:00:43.109423 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m21:00:43.110796 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m21:00:43.112316 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m21:00:43.114080 [error] [MainThread]:                             ^
[0m21:00:43.115458 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m21:00:43.116495 [info ] [MainThread]: 
[0m21:00:43.117428 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m21:00:43.118396 [error] [MainThread]:   relation "public.films" does not exist
[0m21:00:43.119443 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m21:00:43.121049 [error] [MainThread]:                             ^
[0m21:00:43.123939 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m21:00:43.125984 [info ] [MainThread]: 
[0m21:00:43.127226 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m21:00:43.129188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1e2eb730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1e2d7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1e2f7070>]}
[0m21:00:43.130515 [debug] [MainThread]: Flushing usage events


============================== 2024-04-18 21:13:28.917164 | ac8d838b-e65f-431d-83e9-7fa9d3e794e8 ==============================
[0m21:13:28.917164 [info ] [MainThread]: Running with dbt=1.4.7
[0m21:13:28.921045 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:13:28.922173 [debug] [MainThread]: Tracking: tracking
[0m21:13:28.924764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9131b90f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9131b97b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9131b9390>]}
[0m21:13:28.944311 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m21:13:29.213867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:13:29.215592 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:13:29.223989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac8d838b-e65f-431d-83e9-7fa9d3e794e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9118f4af0>]}
[0m21:13:29.254921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac8d838b-e65f-431d-83e9-7fa9d3e794e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9118be110>]}
[0m21:13:29.256013 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m21:13:29.257053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac8d838b-e65f-431d-83e9-7fa9d3e794e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9118be170>]}
[0m21:13:29.260316 [info ] [MainThread]: 
[0m21:13:29.263661 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:13:29.265660 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m21:13:29.287692 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m21:13:29.290172 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m21:13:29.292151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:29.330388 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m21:13:29.333284 [debug] [ThreadPool]: On list_destination_db: Close
[0m21:13:29.337322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m21:13:29.346337 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m21:13:29.348164 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m21:13:29.349936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:29.366972 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m21:13:29.368147 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m21:13:29.368966 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:13:29.373015 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m21:13:29.375712 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m21:13:29.378845 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m21:13:29.386364 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:29.387470 [debug] [MainThread]: On master: BEGIN
[0m21:13:29.388253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:13:29.413046 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:13:29.415643 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:29.416803 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:13:29.423677 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m21:13:29.427429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac8d838b-e65f-431d-83e9-7fa9d3e794e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9117438b0>]}
[0m21:13:29.429519 [debug] [MainThread]: On master: ROLLBACK
[0m21:13:29.434332 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:29.435527 [debug] [MainThread]: On master: BEGIN
[0m21:13:29.440499 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:13:29.442375 [debug] [MainThread]: On master: COMMIT
[0m21:13:29.444222 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:29.446018 [debug] [MainThread]: On master: COMMIT
[0m21:13:29.449197 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m21:13:29.450797 [debug] [MainThread]: On master: Close
[0m21:13:29.452631 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:29.453756 [info ] [MainThread]: 
[0m21:13:29.472386 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m21:13:29.474227 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m21:13:29.476374 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m21:13:29.478186 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m21:13:29.484565 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m21:13:29.496352 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-18 21:13:29.479329 => 2024-04-18 21:13:29.496148
[0m21:13:29.499474 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m21:13:29.540869 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m21:13:29.553540 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:13:29.554551 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m21:13:29.555311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:29.575303 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:13:29.577122 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:13:29.578610 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m21:13:29.584266 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m21:13:29.599741 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:13:29.603037 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m21:13:29.609476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:13:29.615846 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:13:29.618623 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m21:13:29.622239 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:13:29.647812 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m21:13:29.649450 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:13:29.650769 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m21:13:29.657635 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:13:29.663319 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:13:29.664281 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m21:13:29.669432 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:13:29.671443 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-18 21:13:29.500556 => 2024-04-18 21:13:29.671387
[0m21:13:29.672281 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m21:13:29.673619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8d838b-e65f-431d-83e9-7fa9d3e794e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9117b9540>]}
[0m21:13:29.675348 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.20s]
[0m21:13:29.677955 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m21:13:29.679094 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m21:13:29.680086 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m21:13:29.681406 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m21:13:29.682419 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m21:13:29.686649 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m21:13:29.697394 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-18 21:13:29.683066 => 2024-04-18 21:13:29.697219
[0m21:13:29.699805 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m21:13:29.705065 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m21:13:29.716581 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:13:29.717726 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m21:13:29.718959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:29.740531 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:13:29.742245 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:13:29.743934 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m21:13:29.748860 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m21:13:29.752506 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:13:29.753448 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m21:13:29.756290 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:13:29.762471 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:13:29.763878 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m21:13:29.766892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:13:29.769911 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m21:13:29.770939 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:13:29.771715 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m21:13:29.780829 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:13:29.786789 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:13:29.788057 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m21:13:29.796442 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:13:29.800618 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-18 21:13:29.701383 => 2024-04-18 21:13:29.800544
[0m21:13:29.801947 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m21:13:29.803393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8d838b-e65f-431d-83e9-7fa9d3e794e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91181d930>]}
[0m21:13:29.805225 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.12s]
[0m21:13:29.807137 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m21:13:29.809170 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m21:13:29.811341 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m21:13:29.813620 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m21:13:29.814758 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m21:13:29.817968 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m21:13:29.828081 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-18 21:13:29.815479 => 2024-04-18 21:13:29.827892
[0m21:13:29.829760 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m21:13:29.836087 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m21:13:29.847085 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:13:29.848850 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m21:13:29.850588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:29.872393 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:13:29.873434 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:13:29.874303 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m21:13:29.879624 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m21:13:29.883204 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:13:29.884447 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m21:13:29.887867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:13:29.891865 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:13:29.893425 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m21:13:29.898253 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:13:29.901905 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m21:13:29.903074 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:13:29.903974 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m21:13:29.908722 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:13:29.912880 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:13:29.914461 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m21:13:29.924949 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:13:29.928063 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-18 21:13:29.831261 => 2024-04-18 21:13:29.927988
[0m21:13:29.930197 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m21:13:29.931780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8d838b-e65f-431d-83e9-7fa9d3e794e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91181ef80>]}
[0m21:13:29.933153 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.12s]
[0m21:13:29.934329 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m21:13:29.936038 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m21:13:29.936962 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m21:13:29.938505 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m21:13:29.939563 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m21:13:29.945855 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m21:13:29.957042 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-04-18 21:13:29.940374 => 2024-04-18 21:13:29.956811
[0m21:13:29.959226 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m21:13:29.969109 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m21:13:29.984492 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:13:29.986390 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m21:13:29.987622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:30.008014 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:13:30.009650 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:13:30.011087 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH film_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),
films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM film_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m21:13:30.025914 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m21:13:30.032917 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:13:30.035257 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m21:13:30.040244 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:13:30.043920 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m21:13:30.045277 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:13:30.046867 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m21:13:30.054467 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:13:30.058325 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:13:30.059990 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m21:13:30.064296 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:13:30.068268 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-04-18 21:13:29.961482 => 2024-04-18 21:13:30.068197
[0m21:13:30.069580 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m21:13:30.071406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8d838b-e65f-431d-83e9-7fa9d3e794e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe910641a20>]}
[0m21:13:30.073083 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.13s]
[0m21:13:30.075110 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m21:13:30.079365 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:13:30.080651 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:30.081336 [debug] [MainThread]: On master: BEGIN
[0m21:13:30.081946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:13:30.104370 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:13:30.105895 [debug] [MainThread]: On master: COMMIT
[0m21:13:30.106823 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:30.107937 [debug] [MainThread]: On master: COMMIT
[0m21:13:30.112382 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m21:13:30.113730 [debug] [MainThread]: On master: Close
[0m21:13:30.115912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:30.121287 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m21:13:30.122724 [info ] [MainThread]: 
[0m21:13:30.123905 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m21:13:30.125882 [debug] [MainThread]: Command end result
[0m21:13:30.153213 [info ] [MainThread]: 
[0m21:13:30.154603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:13:30.155656 [info ] [MainThread]: 
[0m21:13:30.156719 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:13:30.157964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe910620280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe910642aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9106417b0>]}
[0m21:13:30.159657 [debug] [MainThread]: Flushing usage events


============================== 2024-04-18 21:20:30.015311 | b9f6c2be-ed90-42e2-9da1-0a0d48c751c1 ==============================
[0m21:20:30.015311 [info ] [MainThread]: Running with dbt=1.4.7
[0m21:20:30.018206 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:20:30.019497 [debug] [MainThread]: Tracking: tracking
[0m21:20:30.022113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be8d6d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be8d6d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be8d6d3c0>]}
[0m21:20:30.039036 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m21:20:30.213944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:20:30.215103 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:20:30.222072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9f6c2be-ed90-42e2-9da1-0a0d48c751c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be74aca30>]}
[0m21:20:30.244252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9f6c2be-ed90-42e2-9da1-0a0d48c751c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be7476050>]}
[0m21:20:30.245185 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m21:20:30.246176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9f6c2be-ed90-42e2-9da1-0a0d48c751c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be74760b0>]}
[0m21:20:30.248622 [info ] [MainThread]: 
[0m21:20:30.251186 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:20:30.253140 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m21:20:30.265716 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m21:20:30.267130 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m21:20:30.269074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:30.291694 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m21:20:30.294547 [debug] [ThreadPool]: On list_destination_db: Close
[0m21:20:30.297219 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m21:20:30.304779 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m21:20:30.306412 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m21:20:30.307347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:30.323708 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m21:20:30.325007 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m21:20:30.326057 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:20:30.331124 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m21:20:30.333493 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m21:20:30.337513 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m21:20:30.345848 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:30.347336 [debug] [MainThread]: On master: BEGIN
[0m21:20:30.348610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:20:30.367918 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:20:30.370092 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:30.372319 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:20:30.380679 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m21:20:30.382405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9f6c2be-ed90-42e2-9da1-0a0d48c751c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be72fb8b0>]}
[0m21:20:30.383316 [debug] [MainThread]: On master: ROLLBACK
[0m21:20:30.386368 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:30.387437 [debug] [MainThread]: On master: BEGIN
[0m21:20:30.392961 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:20:30.394164 [debug] [MainThread]: On master: COMMIT
[0m21:20:30.395202 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:30.396127 [debug] [MainThread]: On master: COMMIT
[0m21:20:30.398419 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m21:20:30.399398 [debug] [MainThread]: On master: Close
[0m21:20:30.400510 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:20:30.401481 [info ] [MainThread]: 
[0m21:20:30.417514 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m21:20:30.419305 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m21:20:30.421697 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m21:20:30.423091 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m21:20:30.428155 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m21:20:30.438622 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-18 21:20:30.424017 => 2024-04-18 21:20:30.438342
[0m21:20:30.440653 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m21:20:30.482250 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m21:20:30.493883 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:20:30.494720 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m21:20:30.495478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:30.510928 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:20:30.512198 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:20:30.513247 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m21:20:30.516155 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m21:20:30.524263 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:20:30.525648 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m21:20:30.528920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:20:30.532558 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:20:30.533534 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m21:20:30.537141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:20:30.561179 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m21:20:30.562691 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:20:30.563686 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m21:20:30.567576 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:20:30.573548 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:20:30.574673 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m21:20:30.579735 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:20:30.581778 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-18 21:20:30.442881 => 2024-04-18 21:20:30.581723
[0m21:20:30.582587 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m21:20:30.583821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9f6c2be-ed90-42e2-9da1-0a0d48c751c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be7372a10>]}
[0m21:20:30.585199 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.16s]
[0m21:20:30.587907 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m21:20:30.589088 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m21:20:30.590142 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m21:20:30.591642 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m21:20:30.592498 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m21:20:30.596791 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m21:20:30.608325 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-18 21:20:30.593393 => 2024-04-18 21:20:30.608205
[0m21:20:30.609542 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m21:20:30.613508 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m21:20:30.621875 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:20:30.622726 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m21:20:30.623417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:30.644241 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:20:30.645274 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:20:30.646058 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m21:20:30.649209 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m21:20:30.652737 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:20:30.653751 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m21:20:30.656759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:20:30.662178 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:20:30.663510 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m21:20:30.666644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:20:30.670256 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m21:20:30.671749 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:20:30.672610 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m21:20:30.676686 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:20:30.680958 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:20:30.682118 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m21:20:30.687936 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:20:30.690945 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-18 21:20:30.610261 => 2024-04-18 21:20:30.690886
[0m21:20:30.692079 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m21:20:30.693425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9f6c2be-ed90-42e2-9da1-0a0d48c751c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be73d0550>]}
[0m21:20:30.694613 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.10s]
[0m21:20:30.695554 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m21:20:30.696531 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m21:20:30.697520 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m21:20:30.698845 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m21:20:30.699817 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m21:20:30.703726 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m21:20:30.712106 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-18 21:20:30.700530 => 2024-04-18 21:20:30.712024
[0m21:20:30.712914 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m21:20:30.717301 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m21:20:30.727924 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:20:30.728886 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m21:20:30.729401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:30.747307 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:20:30.748165 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:20:30.748761 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m21:20:30.752794 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m21:20:30.756263 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:20:30.757064 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m21:20:30.759435 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:20:30.762572 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:20:30.763695 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m21:20:30.766671 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:20:30.769792 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m21:20:30.770754 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:20:30.771753 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m21:20:30.776038 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:20:30.779037 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:20:30.779812 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m21:20:30.783891 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:20:30.786256 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-18 21:20:30.713470 => 2024-04-18 21:20:30.786193
[0m21:20:30.787232 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m21:20:30.788805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9f6c2be-ed90-42e2-9da1-0a0d48c751c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be73d3190>]}
[0m21:20:30.790786 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.09s]
[0m21:20:30.792197 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m21:20:30.793897 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m21:20:30.794908 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m21:20:30.796345 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m21:20:30.797338 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m21:20:30.801216 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m21:20:30.810799 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-04-18 21:20:30.798178 => 2024-04-18 21:20:30.810662
[0m21:20:30.811828 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m21:20:30.816343 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m21:20:30.826277 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:20:30.827183 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m21:20:30.828051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:30.845027 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:20:30.846045 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:20:30.846750 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH film_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),
films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM film_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m21:20:30.854986 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m21:20:30.858147 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:20:30.859286 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m21:20:30.861992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:20:30.864186 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m21:20:30.865170 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:20:30.865817 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m21:20:30.869944 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:20:30.873358 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:20:30.875005 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m21:20:30.877631 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:20:30.880767 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-04-18 21:20:30.812665 => 2024-04-18 21:20:30.880715
[0m21:20:30.881698 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m21:20:30.883378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9f6c2be-ed90-42e2-9da1-0a0d48c751c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be51f28f0>]}
[0m21:20:30.884399 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.09s]
[0m21:20:30.886042 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m21:20:30.889390 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:20:30.891435 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:30.892598 [debug] [MainThread]: On master: BEGIN
[0m21:20:30.893528 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:20:30.912563 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:20:30.913717 [debug] [MainThread]: On master: COMMIT
[0m21:20:30.914351 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:30.914846 [debug] [MainThread]: On master: COMMIT
[0m21:20:30.917077 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m21:20:30.918597 [debug] [MainThread]: On master: Close
[0m21:20:30.920504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:30.921788 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m21:20:30.923615 [info ] [MainThread]: 
[0m21:20:30.925313 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m21:20:30.926735 [debug] [MainThread]: Command end result
[0m21:20:30.942840 [info ] [MainThread]: 
[0m21:20:30.944187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:20:30.945089 [info ] [MainThread]: 
[0m21:20:30.945856 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:20:30.946829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be51ecc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be51f17e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be51f1030>]}
[0m21:20:30.947706 [debug] [MainThread]: Flushing usage events


============================== 2024-04-18 23:51:02.083075 | 8dcbf5e6-1c11-4cc1-b657-0225191deb54 ==============================
[0m23:51:02.083075 [info ] [MainThread]: Running with dbt=1.4.7
[0m23:51:02.086615 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/opt/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:51:02.089063 [debug] [MainThread]: Tracking: tracking
[0m23:51:02.092349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87012c1360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87012c17e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87012c13c0>]}
[0m23:51:02.108535 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m23:51:02.345850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:51:02.346956 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:51:02.357028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dcbf5e6-1c11-4cc1-b657-0225191deb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ff9f0a60>]}
[0m23:51:02.378341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dcbf5e6-1c11-4cc1-b657-0225191deb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ff9ba080>]}
[0m23:51:02.379329 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m23:51:02.380492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dcbf5e6-1c11-4cc1-b657-0225191deb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ff9ba0e0>]}
[0m23:51:02.383461 [info ] [MainThread]: 
[0m23:51:02.385485 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:51:02.388252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m23:51:02.399817 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m23:51:02.401110 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m23:51:02.402083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:02.434043 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:51:02.435978 [debug] [ThreadPool]: On list_destination_db: Close
[0m23:51:02.438580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m23:51:02.445126 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:51:02.446240 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m23:51:02.447146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:02.463545 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:51:02.464522 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m23:51:02.465348 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:51:02.470626 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m23:51:02.472668 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m23:51:02.475645 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m23:51:02.484382 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:02.485546 [debug] [MainThread]: On master: BEGIN
[0m23:51:02.486465 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:02.521505 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:51:02.522555 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:02.523161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:51:02.533608 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m23:51:02.535617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dcbf5e6-1c11-4cc1-b657-0225191deb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ffa3f8b0>]}
[0m23:51:02.537110 [debug] [MainThread]: On master: ROLLBACK
[0m23:51:02.539786 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:02.540915 [debug] [MainThread]: On master: BEGIN
[0m23:51:02.545029 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:51:02.546560 [debug] [MainThread]: On master: COMMIT
[0m23:51:02.547581 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:02.548474 [debug] [MainThread]: On master: COMMIT
[0m23:51:02.551426 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:51:02.552859 [debug] [MainThread]: On master: Close
[0m23:51:02.554378 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:51:02.555419 [info ] [MainThread]: 
[0m23:51:02.571595 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m23:51:02.572807 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m23:51:02.574111 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m23:51:02.575085 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m23:51:02.578453 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m23:51:02.589649 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-18 23:51:02.576078 => 2024-04-18 23:51:02.589540
[0m23:51:02.590431 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m23:51:02.628372 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m23:51:02.637866 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:51:02.638855 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m23:51:02.639606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:02.657061 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:51:02.658209 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:51:02.658950 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m23:51:02.662417 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m23:51:02.668623 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:51:02.669569 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m23:51:02.672387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:51:02.675796 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:51:02.676758 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m23:51:02.679633 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:51:02.701033 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m23:51:02.702157 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:51:02.703119 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m23:51:02.707309 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:51:02.713289 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m23:51:02.714927 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m23:51:02.720887 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m23:51:02.723582 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-18 23:51:02.591149 => 2024-04-18 23:51:02.723524
[0m23:51:02.724451 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m23:51:02.725683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dcbf5e6-1c11-4cc1-b657-0225191deb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ff8b6a40>]}
[0m23:51:02.726826 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.15s]
[0m23:51:02.729890 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m23:51:02.731889 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m23:51:02.733362 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m23:51:02.734837 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m23:51:02.735695 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m23:51:02.739007 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m23:51:02.747148 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-18 23:51:02.736447 => 2024-04-18 23:51:02.747011
[0m23:51:02.748156 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m23:51:02.752759 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m23:51:02.760445 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:51:02.761533 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m23:51:02.762469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:02.794816 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:51:02.796036 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:51:02.797073 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m23:51:02.800764 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m23:51:02.803917 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:51:02.804735 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m23:51:02.807162 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:51:02.810707 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:51:02.811724 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m23:51:02.814762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:51:02.817795 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m23:51:02.818946 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:51:02.819758 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m23:51:02.823519 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:51:02.828163 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m23:51:02.829275 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m23:51:02.834497 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m23:51:02.836469 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-18 23:51:02.749108 => 2024-04-18 23:51:02.836421
[0m23:51:02.837351 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m23:51:02.838555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dcbf5e6-1c11-4cc1-b657-0225191deb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ff91b2e0>]}
[0m23:51:02.839796 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.10s]
[0m23:51:02.841238 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m23:51:02.842391 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m23:51:02.843259 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m23:51:02.844390 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m23:51:02.845203 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m23:51:02.849418 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m23:51:02.857482 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-18 23:51:02.845949 => 2024-04-18 23:51:02.857354
[0m23:51:02.858336 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m23:51:02.862754 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m23:51:02.872287 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:51:02.873491 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m23:51:02.874365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:02.890017 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:51:02.891096 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:51:02.891893 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m23:51:02.895035 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m23:51:02.898548 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:51:02.899556 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m23:51:02.902224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:51:02.905404 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:51:02.906336 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m23:51:02.908736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:51:02.911189 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m23:51:02.911880 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:51:02.912714 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m23:51:02.917117 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:51:02.920410 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m23:51:02.921594 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m23:51:02.926521 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m23:51:02.928502 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-18 23:51:02.859057 => 2024-04-18 23:51:02.928425
[0m23:51:02.929651 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m23:51:02.931581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dcbf5e6-1c11-4cc1-b657-0225191deb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ff91a170>]}
[0m23:51:02.933215 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.09s]
[0m23:51:02.934784 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m23:51:02.937327 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m23:51:02.938933 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m23:51:02.940184 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m23:51:02.941161 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m23:51:02.944825 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m23:51:02.953372 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-04-18 23:51:02.941864 => 2024-04-18 23:51:02.953255
[0m23:51:02.954072 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m23:51:02.958261 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m23:51:02.968025 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:51:02.968921 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m23:51:02.969741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:02.985511 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:51:02.986521 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:51:02.987238 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH film_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),
films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM film_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m23:51:02.996483 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m23:51:03.000688 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:51:03.002023 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m23:51:03.005717 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:51:03.008541 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m23:51:03.009475 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:51:03.010254 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m23:51:03.014864 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:51:03.017951 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m23:51:03.018981 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m23:51:03.021660 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m23:51:03.025178 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-04-18 23:51:02.954886 => 2024-04-18 23:51:03.025124
[0m23:51:03.025988 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m23:51:03.027045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dcbf5e6-1c11-4cc1-b657-0225191deb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fd73ab60>]}
[0m23:51:03.028225 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.09s]
[0m23:51:03.029701 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m23:51:03.032564 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:51:03.033725 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:03.034628 [debug] [MainThread]: On master: BEGIN
[0m23:51:03.035879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:03.052581 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:51:03.053797 [debug] [MainThread]: On master: COMMIT
[0m23:51:03.054850 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:03.055550 [debug] [MainThread]: On master: COMMIT
[0m23:51:03.057895 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:51:03.058900 [debug] [MainThread]: On master: Close
[0m23:51:03.060371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:03.061534 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m23:51:03.063024 [info ] [MainThread]: 
[0m23:51:03.064773 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m23:51:03.066108 [debug] [MainThread]: Command end result
[0m23:51:03.086906 [info ] [MainThread]: 
[0m23:51:03.088007 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:51:03.089088 [info ] [MainThread]: 
[0m23:51:03.090141 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:51:03.091198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ff933fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fd73a8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fd73a560>]}
[0m23:51:03.092265 [debug] [MainThread]: Flushing usage events
